# ===================================================================================================
# reliability bins for 2x2 ext-simulated shallow-deep image
metric = list(["# EXT 2x2 SHALLOW-DEEP RELIABILITY:"])
metric.append(" id       fluxes       nd_aegean ns_aegean       aegean       nd_caesar ns_caesar       caesar       nd_profound ns_profound      profound      nd_pybdsf ns_pybdsf       pybdsf       nd_selavy ns_selavy       selavy      ")
metric.append("--- ------------------ --------- --------- ------------------ --------- --------- ------------------ ----------- ----------- ------------------ --------- --------- ------------------ --------- --------- ------------------")
metric.append("  1 1.7634134845437508         0         0                nan         3         0                0.0           0           0                nan         0         0                nan         0         0                nan")
metric.append("  2  2.039529412890583         0         0                nan         4         1               0.25           0           0                nan         0         0                nan         0         0                nan")
metric.append("  3  2.358879674282429         0         0                nan         1         0                0.0           0           0                nan         0         0                nan         0         0                nan")
metric.append("  4 2.7282339163996614         1         1                1.0         3         2 0.6666666666666666           0           0                nan         0         0                nan         0         0                nan")
metric.append("  5 3.1554217808323255        37        32 0.8648648648648649        13        10 0.7692307692307693           0           0                nan         0         0                nan         0         0                nan")
metric.append("  6  3.649498877314183       125        96              0.768        35        32 0.9142857142857143          18          18                1.0         2         2                1.0         0         0                nan")
metric.append("  7  4.220938746263039       133       121 0.9097744360902256        58        55 0.9482758620689655          26          26                1.0        19        19                1.0         0         0                nan")
metric.append("  8   4.88185487888583        77        73  0.948051948051948        66        59 0.8939393939393939          34          34                1.0        57        57                1.0         4         3               0.75")
metric.append("  9   5.64625750127296        59        59                1.0        72        65 0.9027777777777778          60          55 0.9166666666666666        74        73 0.9864864864864865        28        26 0.9285714285714286")
metric.append(" 10 6.5303505658400685        66        66                1.0        84        74 0.8809523809523809          53          44 0.8301886792452831        68        67 0.9852941176470589        52        46 0.8846153846153846")
metric.append(" 11  7.552875245798337        80        75             0.9375        97        82  0.845360824742268          74          67 0.9054054054054054        89        85 0.9550561797752809        53        51 0.9622641509433962")
metric.append(" 12  8.735507214114598        78        75 0.9615384615384616        97        86 0.8865979381443299          73          59 0.8082191780821918        98        86 0.8775510204081632        61        58 0.9508196721311475")
metric.append(" 13 10.103316128556331        62        59 0.9516129032258065        76        58 0.7631578947368421          70          61 0.8714285714285714        89        72 0.8089887640449438        54        49 0.9074074074074074")
metric.append(" 14 11.685297063073024        57        54 0.9473684210526315        69        54  0.782608695652174          87          78  0.896551724137931        99        69  0.696969696969697        49        44 0.8979591836734694")
metric.append(" 15 13.514985150897594        44        43 0.9772727272727273        65        52                0.8          91          80 0.8791208791208791        89        69 0.7752808988764045        43        40 0.9302325581395349")
metric.append(" 16  15.63116646868946        42        42                1.0        49        41 0.8367346938775511          47          43 0.9148936170212766        65        50 0.7692307692307693        32        30             0.9375")
metric.append(" 17 18.078700231176676        44        43 0.9772727272727273        55        45 0.8181818181818182          58          56 0.9655172413793104        63        55  0.873015873015873        39        37 0.9487179487179487")
metric.append(" 18  20.90946972533588        37        37                1.0        46        37 0.8043478260869565          38          38                1.0        59        52 0.8813559322033898        31        30  0.967741935483871")
metric.append(" 19 24.183482142193892        33        33                1.0        41        39 0.9512195121951219          57          56 0.9824561403508771        49        45 0.9183673469387755        33        28 0.8484848484848485")
metric.append(" 20 27.970140620695087        28        27 0.9642857142857143        38        34 0.8947368421052632          34          33 0.9705882352941176        41        34 0.8292682926829268        23        22 0.9565217391304348")
metric.append(" 21  32.34971546866265        35        34 0.9714285714285714        47        42 0.8936170212765957          41          41                1.0        51        49 0.9607843137254902        39        37 0.9487179487179487")
metric.append(" 22 37.415045748076224        17        17                1.0        31        25 0.8064516129032258          26          26                1.0        22        20 0.9090909090909091        16        14              0.875")
metric.append(" 23  43.27350729519441        19        19                1.0        25        21               0.84          30          30                1.0        30        29 0.9666666666666667        17        15 0.8823529411764706")
metric.append(" 24  50.04928889398799        26        25 0.9615384615384616        29        25 0.8620689655172413          24          24                1.0        31        31                1.0        23        21 0.9130434782608695")
metric.append(" 25 57.886024853641715        15        15                1.0        19        18 0.9473684210526315          23          23                1.0        26        25 0.9615384615384616        17        15 0.8823529411764706")
metric.append(" 26  66.94983979600418        18        18                1.0        16        16                1.0          19          19                1.0        17        17                1.0        16        16                1.0")
metric.append(" 27   77.4328701969701        13        13                1.0        16        15             0.9375          14          14                1.0        15        15                1.0        12        11 0.9166666666666666")
metric.append(" 28   89.5573373321003        23        23                1.0        20        20                1.0          20          20                1.0        18        18                1.0        19        19                1.0")
metric.append(" 29 103.58025796555644        16        16                1.0        21        21                1.0          18          18                1.0        24        24                1.0        20        18                0.9")
metric.append(" 30 119.79889264043169        14        14                1.0        13        12 0.9230769230769231          14          14                1.0        14        14                1.0        14        13 0.9285714285714286")
metric.append(" 31 138.55704706437484        14        14                1.0        16        15             0.9375          15          15                1.0        19        19                1.0        17        15 0.8823529411764706")
metric.append(" 32 160.25236016847882        11        11                1.0         8         8                1.0           9           9                1.0        11        11                1.0         8         8                1.0")
metric.append(" 33 185.34473333309631         4         4                1.0         3         3                1.0           7           7                1.0         9         9                1.0         7         6 0.8571428571428571")
metric.append(" 34 214.36607946491694         5         5                1.0         6         6                1.0           4           4                1.0         6         6                1.0         5         4                0.8")
metric.append(" 35 247.93159858809653         8         8                1.0         7         7                1.0           8           8                1.0        10        10                1.0         9         8 0.8888888888888888")
metric.append(" 36  286.7528189715727         6         6                1.0         6         6                1.0           7           7                1.0         8         8                1.0         7         5 0.7142857142857143")
metric.append(" 37 331.65268024086095         4         4                1.0         4         4                1.0           3           3                1.0         4         4                1.0         4         4                1.0")
metric.append(" 38 383.58297820901663         8         8                1.0         7         7                1.0           8           8                1.0         8         8                1.0         7         6 0.8571428571428571")
metric.append(" 39  443.6445412256047         0         0                nan         0         0                nan           0           0                nan         0         0                nan         0         0                nan")
metric.append(" 40  513.1105657457731         4         4                1.0         4         4                1.0           4           4                1.0         4         4                1.0         4         4                1.0")
metric.append(" 41  593.4536057912671         5         5                1.0         5         5                1.0           5           5                1.0         5         5                1.0         5         5                1.0")
metric.append(" 42  686.3767884311153         4         4                1.0         4         4                1.0           4           4                1.0         4         4                1.0         4         4                1.0")
metric.append(" 43  793.8499169937053         3         3                1.0         3         3                1.0           3           3                1.0         3         3                1.0         2         2                1.0")
metric.append(" 44  918.1512273330019         3         3                1.0         3         3                1.0           3           3                1.0         3         3                1.0         3         3                1.0")
metric.append(" 45 1061.9156823062076         2         2                1.0         2         2                1.0           2           2                1.0         2         2                1.0         2         2                1.0")
metric.append(" 46 1228.1908282183997         3         3                1.0         3         3                1.0           3           3                1.0         3         3                1.0         3         2 0.6666666666666666")
metric.append(" 47 1420.5013972896847         1         1                1.0         1         1                1.0           1           1                1.0         1         1                1.0         1         1                1.0")
metric.append(" 48 1642.9240256003077         2         2                1.0         2         2                1.0           2           2                1.0         2         2                1.0         2         2                1.0")
metric.append(" 49 1900.1736703989077         0         0                nan         0         0                nan           0           0                nan         0         0                nan         0         0                nan")
metric.append(" 50 2197.7035586645356         1         1                1.0         1         1                1.0           1           1                1.0         1         1                1.0         1         1                1.0")


# reliability bins for 2x2 ext-simulated shallow-deep image
cluster_cat     = "ext_2x2/xtables/emu_simulated_2x2.hydra.cluster_catalogue.fits"
injected_cat    = "ext_2x2/xtables/emu_simulated_2x2.hydra.emusim2x2.external_catalogue.fits"
reliability_cat = "ext_2x2/xtables/reliability_deep_shallow_image_plot_data_table.fits"
bins=[1.763413,2.039529,2.358880,2.728234,3.155422,3.649499,4.220939,4.881855,5.646258,6.530351,7.552875,8.735507,10.103316,11.685297,13.514985,15.631166,18.078700,20.909470,24.183482,27.970141,32.349715,37.415046,43.273507,50.049289,57.886025,66.949840,77.432870,89.557337,103.580258,119.798893,138.557047,160.252360,185.344733,214.366079,247.931599,286.752819,331.652680,383.582978,443.644541,513.110566,593.453606,686.376788,793.849917,918.151227,1061.915682,1228.190828,1420.501397,1642.924026,1900.173670,2197.703559,2541.820786]

cd = sdReliability(reliability_cat,cluster_cat,injected_cat,'EMUSim2x2',bins,'shallow_deep')
qi = cd.get_injected()
qc = cd.get_cluster()
cd.get_stats(1)

