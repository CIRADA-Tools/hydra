# ===================================================================================================
# reliability bins for 2x2 ext-simulated image
metric = list(["# EXT 2x2 SHALLOW RELIABILITY:"])
metric.append(" id       fluxes       nd_aegean ns_aegean       aegean       nd_caesar ns_caesar       caesar       nd_profound ns_profound      profound      nd_pybdsf ns_pybdsf       pybdsf       nd_selavy ns_selavy       selavy      ")
metric.append("--- ------------------ --------- --------- ------------------ --------- --------- ------------------ ----------- ----------- ------------------ --------- --------- ------------------ --------- --------- ------------------")
metric.append("  1  0.903043142080459         0         0                nan         1         1                1.0           0           0                nan         0         0                nan         0         0                nan")
metric.append("  2  1.058515513549366         0         0                nan         0         0                nan           0           0                nan         0         0                nan         0         0                nan")
metric.append("  3 1.2407547770567624         0         0                nan         1         0                0.0           0           0                nan         0         0                nan         0         0                nan")
metric.append("  4 1.4543692530561858         0         0                nan         0         0                nan           0           0                nan         0         0                nan         1         1                1.0")
metric.append("  5 1.7047606532313526         0         0                nan         3         1 0.3333333333333333           0           0                nan         0         0                nan         0         0                nan")
metric.append("  6  1.998260674652419         0         0                nan         3         2 0.6666666666666666           0           0                nan         0         0                nan         0         0                nan")
metric.append("  7 2.3422911106574236         0         0                nan         2         1                0.5           0           0                nan         0         0                nan         0         0                nan")
metric.append("  8 2.7455515272145807         1         1                1.0         4         2                0.5           0           0                nan         0         0                nan         0         0                nan")
metric.append("  9 3.2182392505748654        67        57 0.8507462686567164        15        13 0.8666666666666667           3           3                1.0         0         0                nan         0         0                nan")
metric.append(" 10  3.772307229086364       137       122 0.8905109489051095        47        46 0.9787234042553191          18          18                1.0         5         5                1.0         0         0                nan")
metric.append(" 11  4.421766289773306       121       117 0.9669421487603306        73        72 0.9863013698630136          40          40                1.0        33        33                1.0         0         0                nan")
metric.append(" 12  5.183039432901916        78        78                1.0        71        68 0.9577464788732394          40          38               0.95        79        79                1.0        18        18                1.0")
metric.append(" 13  6.075377123650165        71        71                1.0        84        76 0.9047619047619048          73          67 0.9178082191780822        73        73                1.0        39        38 0.9743589743589743")
metric.append(" 14  7.121344082444344        76        74 0.9736842105263158       103        96 0.9320388349514563          71          69  0.971830985915493        85        84 0.9882352941176471        61        61                1.0")
metric.append(" 15  8.347389883526398        88        85 0.9659090909090909       109        99  0.908256880733945          76          68 0.8947368421052632       107       100 0.9345794392523364        68        67 0.9852941176470589")
metric.append(" 16  9.784517790591313        69        66 0.9565217391304348        85        79 0.9294117647058824          81          75 0.9259259259259259       102        88 0.8627450980392157        60        60                1.0")
metric.append(" 17 11.469068742474194        63        63                1.0        76        69 0.9078947368421053          83          76 0.9156626506024096       108        88 0.8148148148148148        53        53                1.0")
metric.append(" 18 13.443640313688789        50        48               0.96        69        61 0.8840579710144928         103          99 0.9611650485436893        94        79 0.8404255319148937        47        47                1.0")
metric.append(" 19 15.758163887755167        48        48                1.0        54        48 0.8888888888888888          55          53 0.9636363636363636        71        55 0.7746478873239436        35        35                1.0")
metric.append(" 20  18.47116728201239        46        46                1.0        63        53 0.8412698412698413          63          62 0.9841269841269841        74        67 0.9054054054054054        43        43                1.0")
metric.append(" 21 21.651254752160618        46        46                1.0        52        44 0.8461538461538461          42          39 0.9285714285714286        55        47 0.8545454545454545        35        35                1.0")
metric.append(" 22  25.37884180170153        27        27                1.0        38        37 0.9736842105263158          51          50 0.9803921568627451        55        50 0.9090909090909091        31        31                1.0")
metric.append(" 23 29.748188664747886        36        36                1.0        46        41 0.8913043478260869          47          46 0.9787234042553191        45        43 0.9555555555555556        36        35 0.9722222222222222")
metric.append(" 24  34.86978388328588        25        25                1.0        41        38  0.926829268292683          30          29 0.9666666666666667        41        38  0.926829268292683        27        27                1.0")
metric.append(" 25  40.87313825288222        19        19                1.0        26        25 0.9615384615384616          27          27                1.0        30        29 0.9666666666666667        16        15             0.9375")
metric.append(" 26  47.91005978789556        26        25 0.9615384615384616        33        29 0.8787878787878788          32          30             0.9375        30        28 0.9333333333333333        23        23                1.0")
metric.append(" 27 56.158492520888494        21        21                1.0        25        21               0.84          27          27                1.0        32        31            0.96875        22        21 0.9545454545454546")
metric.append(" 28  65.82701620872302        17        17                1.0        16        16                1.0          20          19               0.95        19        19                1.0        16        16                1.0")
metric.append(" 29  77.16012073030134        16        16                1.0        18        17 0.9444444444444444          16          16                1.0        16        16                1.0        14        14                1.0")
metric.append(" 30   90.4443885506956        25        25                1.0        24        23 0.9583333333333334          23          22 0.9565217391304348        20        20                1.0        19        19                1.0")
metric.append(" 31 106.01574158886423        18        18                1.0        20        19               0.95          19          19                1.0        23        22 0.9565217391304348        21        20 0.9523809523809523")
metric.append(" 32 124.26793574193937        11        11                1.0        13        12 0.9230769230769231          12          11 0.9166666666666666        18        18                1.0        15        15                1.0")
metric.append(" 33 145.66251786880707        14        14                1.0        15        15                1.0          15          15                1.0        17        16 0.9411764705882353        15        15                1.0")
metric.append(" 34 170.74049701720276        11        11                1.0         7         7                1.0          10          10                1.0        13        13                1.0        10        10                1.0")
metric.append(" 35 200.13602502695895         6         6                1.0         6         6                1.0           7           7                1.0         9         9                1.0         8         8                1.0")
metric.append(" 36 234.59243245353733         6         6                1.0         6         6                1.0           6           6                1.0         8         8                1.0         7         6 0.8571428571428571")
metric.append(" 37  274.9810253154287         8         8                1.0         8         7              0.875           8           8                1.0        10        10                1.0         9         9                1.0")
metric.append(" 38 322.32311798250583         4         4                1.0         3         3                1.0           4           4                1.0         3         3                1.0         4         4                1.0")
metric.append(" 39  377.8158593553511         8         8                1.0         8         8                1.0           8           8                1.0         9         9                1.0         7         7                1.0")
metric.append(" 40 442.86250540729117         0         0                nan         0         0                nan           0           0                nan         0         0                nan         0         0                nan")
metric.append(" 41  519.1079035969145         5         5                1.0         5         5                1.0           5           5                1.0         5         5                1.0         5         5                1.0")
metric.append(" 42  608.4800864524643         6         6                1.0         6         6                1.0           6           6                1.0         6         6                1.0         6         6                1.0")
metric.append(" 43  713.2390261133353         4         4                1.0         4         4                1.0           4           4                1.0         4         4                1.0         3         3                1.0")
metric.append(" 44  836.0337826944489         3         3                1.0         3         3                1.0           3           3                1.0         3         3                1.0         3         3                1.0")
metric.append(" 45  979.9694915955489         2         2                1.0         2         2                1.0           2           2                1.0         2         2                1.0         2         2                1.0")
metric.append(" 46 1148.6858836768083         3         3                1.0         3         3                1.0           3           3                1.0         3         3                1.0         3         3                1.0")
metric.append(" 47 1346.4493238560356         2         2                1.0         2         2                1.0           2           2                1.0         2         2                1.0         2         2                1.0")
metric.append(" 48 1578.2606955257547         2         2                1.0         2         2                1.0           2           2                1.0         2         2                1.0         2         2                1.0")
metric.append(" 49 1849.9818588848505         0         0                nan         0         0                nan           0           0                nan         0         0                nan         0         0                nan")
metric.append(" 50 2168.4838809617295         1         1                1.0         1         1                1.0           1           1                1.0         1         1                1.0         1         1                1.0")


# reliability bins for 2x2 ext-simulated shallow image
cluster_cat =  "ext_2x2/xtables/emu_simulated_2x2.hydra.cluster_catalogue.fits"
injected_cat = "ext_2x2/xtables/emu_simulated_2x2.hydra.emusim2x2.external_catalogue.fits"
bins=[0.903043,1.058516,1.240755,1.454369,1.704761,1.998261,2.342291,2.745552,3.218239,3.772307,4.421766,5.183039,6.075377,7.121344,8.347390,9.784518,11.469069,13.443640,15.758164,18.471167,21.651255,25.378842,29.748189,34.869784,40.873138,47.910060,56.158493,65.827016,77.160121,90.444389,106.015742,124.267936,145.662518,170.740497,200.136025,234.592432,274.981025,322.323118,377.815859,442.862505,519.107904,608.480086,713.239026,836.033783,979.969492,1148.685884,1346.449324,1578.260696,1849.981859,2168.483881,2541.820786]

cd = Clump(cluster_cat,injected_cat,'EMUSim2x2',bins,'shallow')
qi = cd.get_injected()
qc = cd.get_cluster()
cd.get_clump_ids(31)

