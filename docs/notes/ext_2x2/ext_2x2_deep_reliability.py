# ===================================================================================================
# reliability bins for 2x2 ext-simulated deep image
metric = list(["# EXT 2x2 DEEP RELIABILITY:"])
metric.append(" id        fluxes        nd_aegean ns_aegean       aegean       nd_caesar ns_caesar        caesar       nd_profound ns_profound      profound      nd_pybdsf ns_pybdsf       pybdsf       nd_selavy ns_selavy       selavy      ")
metric.append("--- -------------------- --------- --------- ------------------ --------- --------- ------------------- ----------- ----------- ------------------ --------- --------- ------------------ --------- --------- ------------------")
metric.append("  1 0.002904193970828929         0         0                nan         1         1                 1.0           0           0                nan         0         0                nan         0         0                nan")
metric.append("  2 0.003934615074539634         0         0                nan         0         0                 nan           0           0                nan         0         0                nan         0         0                nan")
metric.append("  3 0.005330634227704775         0         0                nan         0         0                 nan           0           0                nan         0         0                nan         0         0                nan")
metric.append("  4 0.007221967265222871         0         0                nan         0         0                 nan           0           0                nan         0         0                nan         0         0                nan")
metric.append("  5 0.009784353784560454         0         0                nan         0         0                 nan           0           0                nan         0         0                nan         0         0                nan")
metric.append("  6 0.013255886584039804         0         0                nan         0         0                 nan           0           0                nan         0         0                nan         0         0                nan")
metric.append("  7 0.017959134859392285         0         0                nan         0         0                 nan           0           0                nan         0         0                nan         0         0                nan")
metric.append("  8 0.024331116810109743         0         0                nan         0         0                 nan           0           0                nan         0         0                nan         0         0                nan")
metric.append("  9  0.03296390666155049         0         0                nan         1         0                 0.0           0           0                nan         0         0                nan         0         0                nan")
metric.append(" 10  0.04465964924141563         0         0                nan         0         0                 nan           0           0                nan         0         0                nan         0         0                nan")
metric.append(" 11 0.060505093975789806         0         0                nan         1         1                 1.0           0           0                nan         0         0                nan         0         0                nan")
metric.append(" 12   0.0819725738827391         0         0                nan         0         0                 nan           0           0                nan         0         0                nan         0         0                nan")
metric.append(" 13  0.11105681236772934         0         0                nan         4         2                 0.5           0           0                nan         0         0                nan         0         0                nan")
metric.append(" 14  0.15046026968634835         0         0                nan         2         1                 0.5           0           0                nan         0         0                nan         0         0                nan")
metric.append(" 15   0.2038442511669538         0         0                nan         2         0                 0.0           0           0                nan         0         0                nan         0         0                nan")
metric.append(" 16   0.2761691097619128         0         0                nan         1         0                 0.0           0           0                nan         0         0                nan         0         0                nan")
metric.append(" 17  0.37415515399657173         0         0                nan         3         1  0.3333333333333333           0           0                nan         0         0                nan         0         0                nan")
metric.append(" 18   0.5069070881348258         0         0                nan         3         0                 0.0           0           0                nan         0         0                nan         0         0                nan")
metric.append(" 19   0.6867600065284211         0         0                nan         2         2                 1.0           0           0                nan         0         0                nan         0         0                nan")
metric.append(" 20   0.9304255505724388         0         0                nan         8         4                 0.5           0           0                nan         0         0                nan         0         0                nan")
metric.append(" 21   1.2605447273118107         0         0                nan         4         1                0.25           0           0                nan         2         2                1.0         2         2                1.0")
metric.append(" 22   1.7077916750845898         1         1                1.0        14         6 0.42857142857142855           5           5                1.0         4         4                1.0         0         0                nan")
metric.append(" 23    2.313723854692532        53        42 0.7924528301886793        20        15                0.75          44          40 0.9090909090909091        23        22 0.9565217391304348         6         5 0.8333333333333334")
metric.append(" 24   3.1346435012385867       819       728 0.8888888888888888       182       167  0.9175824175824175         226         203 0.8982300884955752       158       152 0.9620253164556962        11         9 0.8181818181818182")
metric.append(" 25    4.246829136471461       407       397 0.9754299754299754       367       348  0.9482288828337875         346         303 0.8757225433526011       557       496 0.8904847396768402       121       117 0.9669421487603306")
metric.append(" 26    5.753623245277037       464       448 0.9655172413793104       444       412  0.9279279279279279         488         437 0.8954918032786885       789       652  0.826362484157161       339       333 0.9823008849557522")
metric.append(" 27    7.795034691717631       440       422 0.9590909090909091       452       425  0.9402654867256637         447         412 0.9217002237136466       755       610 0.8079470198675497       382       376 0.9842931937172775")
metric.append(" 28   10.560748115539091       338       325 0.9615384615384616       343       312  0.9096209912536443         403         382 0.9478908188585607       558       468 0.8387096774193549       281       280   0.99644128113879")
metric.append(" 29    14.30774912116357       274       256 0.9343065693430657       290       260   0.896551724137931         332         328 0.9879518072289156       382       334 0.8743455497382199       232       229 0.9870689655172413")
metric.append(" 30    19.38420296313516       246       240  0.975609756097561       297       267   0.898989898989899         277         276 0.9963898916967509       284       269 0.9471830985915493       209       207 0.9904306220095693")
metric.append(" 31    26.26180549673074       193       187 0.9689119170984456       240       209  0.8708333333333333         222         220  0.990990990990991       210       204 0.9714285714285714       166       162 0.9759036144578314")
metric.append(" 32    35.57961239158266       181       177 0.9779005524861878       204       188  0.9215686274509803         196         194 0.9897959183673469       182       179 0.9835164835164835       140       136 0.9714285714285714")
metric.append(" 33   48.203419147737264       127       127                1.0       140       130  0.9285714285714286         153         145 0.9477124183006536       151       144 0.9536423841059603       114       111 0.9736842105263158")
metric.append(" 34    65.30620940890711       114       114                1.0       115       108  0.9391304347826087         117         112 0.9572649572649573       130       125 0.9615384615384616       108       105 0.9722222222222222")
metric.append(" 35    88.47714669966992        90        89 0.9888888888888889        97        94  0.9690721649484536          99          96 0.9696969696969697       114       110 0.9649122807017544        97        93 0.9587628865979382")
metric.append(" 36   119.86923692201344        76        75 0.9868421052631579        85        76  0.8941176470588236          77          76  0.987012987012987        80        77             0.9625        70        66 0.9428571428571428")
metric.append(" 37   162.39938217084705        53        53                1.0        51        50  0.9803921568627451          59          58 0.9830508474576272        64        62            0.96875        55        52 0.9454545454545454")
metric.append(" 38   220.01941454446222        47        47                1.0        48        46  0.9583333333333334          46          44 0.9565217391304348        51        50 0.9803921568627451        43        42 0.9767441860465116")
metric.append(" 39    298.0832939719023        40        40                1.0        44        40  0.9090909090909091          45          44 0.9777777777777777        44        42 0.9545454545454546        36        35 0.9722222222222222")
metric.append(" 40   403.84458948364176        33        33                1.0        33        33                 1.0          33          33                1.0        34        34                1.0        32        32                1.0")
metric.append(" 41    547.1304690781639        31        31                1.0        31        31                 1.0          32          32                1.0        31        31                1.0        27        27                1.0")
metric.append(" 42    741.2548242294013        25        25                1.0        24        24                 1.0          23          23                1.0        26        26                1.0        21        21                1.0")
metric.append(" 43   1004.2553750828747        14        14                1.0        14        14                 1.0          15          14 0.9333333333333333        13        13                1.0        10        10                1.0")
metric.append(" 44    1360.569706148353        13        13                1.0        13        13                 1.0          13          13                1.0        14        14                1.0        12        12                1.0")
metric.append(" 45   1843.3059670065013         6         6                1.0         6         6                 1.0           6           6                1.0         6         6                1.0         6         6                1.0")
metric.append(" 46    2497.319227855341        11        11                1.0        11        11                 1.0          10          10                1.0        11        11                1.0        10        10                1.0")
metric.append(" 47    3383.379339863007         5         5                1.0         5         5                 1.0           6           6                1.0         5         5                1.0         4         4                1.0")
metric.append(" 48    4583.817571149108         7         7                1.0         7         7                 1.0           7           7                1.0         7         7                1.0         7         7                1.0")
metric.append(" 49    6210.176694649337         2         2                1.0         2         2                 1.0           2           2                1.0         2         2                1.0         2         2                1.0")
metric.append(" 50    8413.575361616686         1         1                1.0         1         1                 1.0           1           1                1.0         1         1                1.0         1         1                1.0")


# reliability bins for 2x2 simulated deep image
cluster_cat  = "ext_2x2/xtables/emu_simulated_ext2x2.hydra.cluster_catalogue.fits"
injected_cat = "ext_2x2/xtables/emu_simulated_ext2x2.hydra.emusim2x2.external_catalogue.fits"
bins=[0.002904,0.003935,0.005331,0.007222,0.009784,0.013256,0.017959,0.024331,0.032964,0.044660,0.060505,0.081973,0.111057,0.150460,0.203844,0.276169,0.374155,0.506907,0.686760,0.930426,1.260545,1.707792,2.313724,3.134644,4.246829,5.753623,7.795035,10.560748,14.307749,19.384203,26.261805,35.579612,48.203419,65.306209,88.477147,119.869237,162.399382,220.019415,298.083294,403.844589,547.130469,741.254824,1004.255375,1360.569706,1843.305967,2497.319228,3383.379340,4583.817571,6210.176695,8413.575362,11398.749802]

cd = Clump(cluster_cat,injected_cat,'EMUSim2x2',bins,'deep')
qi = cd.get_injected()
qc = cd.get_cluster()
cd.get_clump_ids(1)

